/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Injectable } from '@angular/core';
import { HttpClient, HttpHeaders } from '@angular/common/http';
import { catchError, map } from 'rxjs/operators';
import { VersionService } from './version.service';
import { AlertHandlerService } from './alert-handler.service';
import { ValidationErrorService } from './validation-error.service';
import { ApiResponseBody } from '../utilities/ApiResponseBody';
import { ShHttpClientConst, Response } from '../constShHttpClient';
import { SHMessage } from '../utilities/ShMessage';
import { ShRedirectService } from './sh-redirect.service';
import * as i0 from "@angular/core";
import * as i1 from "@angular/common/http";
import * as i2 from "./version.service";
import * as i3 from "./alert-handler.service";
import * as i4 from "./validation-error.service";
import * as i5 from "./sh-redirect.service";
var ShHttpClientService = /** @class */ (function () {
    function ShHttpClientService(http, versionService, alertHandlerService, validationErrorService, redirectService) {
        this.http = http;
        this.versionService = versionService;
        this.alertHandlerService = alertHandlerService;
        this.validationErrorService = validationErrorService;
        this.redirectService = redirectService;
    }
    Object.defineProperty(ShHttpClientService.prototype, "hasToken", {
        /**
         * AccessTokenの有無を返す
         */
        get: /**
         * AccessTokenの有無を返す
         * @return {?}
         */
        function () {
            return !!sessionStorage.getItem('AccessToken');
        },
        enumerable: true,
        configurable: true
    });
    /**
     * httpOptionを返す
     * @param versionNo
     */
    /**
     * httpOptionを返す
     * @private
     * @param {?} versionNo
     * @return {?}
     */
    ShHttpClientService.prototype.getOption = /**
     * httpOptionを返す
     * @private
     * @param {?} versionNo
     * @return {?}
     */
    function (versionNo) {
        /** @type {?} */
        var token = sessionStorage.getItem("" + ShHttpClientConst.AUTHORIZATION_TOKEN);
        /** @type {?} */
        var headers = new HttpHeaders({ "Version-No": versionNo });
        headers = headers.set('Content-Type', 'application/json; charset=utf-8');
        /** @type {?} */
        var accessToken = token ? ShHttpClientConst.Bearer + token : ShHttpClientConst.Bearer;
        headers = headers.set('Authorization', accessToken);
        return { observe: Response, headers: headers };
    };
    /**
    * GET
    * @param apiResponseBody レスポンスBody情報
    * @return レスポンスBody内のbody句
    */
    /**
     * GET
     * @private
     * @template T
     * @param {?} apiResponseBody レスポンスBody情報
     * @param {?} showValidationResult
     * @return {?} レスポンスBody内のbody句
     */
    ShHttpClientService.prototype.getApiResponseBody = /**
     * GET
     * @private
     * @template T
     * @param {?} apiResponseBody レスポンスBody情報
     * @param {?} showValidationResult
     * @return {?} レスポンスBody内のbody句
     */
    function (apiResponseBody, showValidationResult) {
        if (apiResponseBody.status != ShHttpClientConst.STATUS_OK)
            return new ApiResponseBody();
        if (apiResponseBody.body) {
            if (apiResponseBody.body.message) {
                alert(apiResponseBody.body.message);
            }
            if (apiResponseBody.body.message) {
                alert(apiResponseBody.body.message);
            }
            if (apiResponseBody.body.redirectURL == ShHttpClientConst.RELOAD) {
                setTimeout((/**
                 * @return {?}
                 */
                function () { location.reload(); }), 100);
            }
            else if ((apiResponseBody.body.redirectURL || "").indexOf(ShHttpClientConst.HTTP) != -1) {
                // useHashがtrueになっていることが前提条件です
                this.redirectService.setRedirectPath();
                setTimeout((/**
                 * @return {?}
                 */
                function () { location.href = apiResponseBody.body.redirectURL; }), 100);
            }
            if (showValidationResult) {
                //バリデーション処理
                if (apiResponseBody.body.hasValidationErrors) {
                    this.validationErrorService.setValidationError(apiResponseBody.body.validationErrors);
                }
                else {
                    this.validationErrorService.clearValidationError();
                }
            }
            if (apiResponseBody.body.alert) {
                //アラート処理
                this.alertHandlerService.setAlert(apiResponseBody.body.alert);
            }
        }
        return apiResponseBody.body;
    };
    /**
     * 認証済みかどうか
     */
    /**
     * 認証済みかどうか
     * @private
     * @return {?}
     */
    ShHttpClientService.prototype.isAuthenticate = /**
     * 認証済みかどうか
     * @private
     * @return {?}
     */
    function () {
        return !!sessionStorage.getItem("" + ShHttpClientConst.AUTHORIZATION_TOKEN);
    };
    /**
    * GET
    * @param url ApiUrl
    * @return API返却結果
    */
    /**
     * GET
     * @template T
     * @param {?} url ApiUrl
     * @param {?=} showValidationResult
     * @return {?} API返却結果
     */
    ShHttpClientService.prototype.get = /**
     * GET
     * @template T
     * @param {?} url ApiUrl
     * @param {?=} showValidationResult
     * @return {?} API返却結果
     */
    function (url, showValidationResult) {
        if (showValidationResult === void 0) { showValidationResult = true; }
        return tslib_1.__awaiter(this, void 0, void 0, function () {
            var versionNo, option;
            var _this = this;
            return tslib_1.__generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        versionNo = "";
                        if (!this.isAuthenticate()) return [3 /*break*/, 2];
                        return [4 /*yield*/, this.versionService.getVersion(url)];
                    case 1:
                        versionNo = _a.sent();
                        _a.label = 2;
                    case 2:
                        option = this.getOption(versionNo);
                        return [2 /*return*/, this.http.get(this.encodeUrl(url), option).pipe(map((/**
                             * @param {?} response
                             * @return {?}
                             */
                            function (response) {
                                return _this.getApiResponseBody(response, showValidationResult);
                            })), catchError(this.handleError("get error"))).toPromise()];
                }
            });
        });
    };
    /**
    * POST
    * @param url ApiUrl
    * @param data データ
    * @return API返却結果
    */
    /**
     * POST
     * @template T
     * @param {?} url ApiUrl
     * @param {?} data データ
     * @param {?=} showValidationResult
     * @return {?} API返却結果
     */
    ShHttpClientService.prototype.post = /**
     * POST
     * @template T
     * @param {?} url ApiUrl
     * @param {?} data データ
     * @param {?=} showValidationResult
     * @return {?} API返却結果
     */
    function (url, data, showValidationResult) {
        if (showValidationResult === void 0) { showValidationResult = true; }
        return tslib_1.__awaiter(this, void 0, void 0, function () {
            var versionNo, option;
            var _this = this;
            return tslib_1.__generator(this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.versionService.getVersion(url)];
                    case 1:
                        versionNo = _a.sent();
                        option = this.getOption(versionNo);
                        return [2 /*return*/, this.http.post(url, data, option).pipe(map((/**
                             * @param {?} response
                             * @return {?}
                             */
                            function (response) {
                                return _this.getApiResponseBody(response, showValidationResult);
                            })), catchError(this.handleError("post error"))).toPromise()];
                }
            });
        });
    };
    /**
    * PUT
    * @param url ApiUrl
    * @param data データ
    * @return API返却結果
    */
    /**
     * PUT
     * @template T
     * @param {?} url ApiUrl
     * @param {?} data データ
     * @param {?=} showValidationResult
     * @return {?} API返却結果
     */
    ShHttpClientService.prototype.put = /**
     * PUT
     * @template T
     * @param {?} url ApiUrl
     * @param {?} data データ
     * @param {?=} showValidationResult
     * @return {?} API返却結果
     */
    function (url, data, showValidationResult) {
        if (showValidationResult === void 0) { showValidationResult = true; }
        return tslib_1.__awaiter(this, void 0, void 0, function () {
            var versionNo, option;
            var _this = this;
            return tslib_1.__generator(this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.versionService.getVersion(url)];
                    case 1:
                        versionNo = _a.sent();
                        option = this.getOption(versionNo);
                        return [2 /*return*/, this.http.put(url, data, option).pipe(map((/**
                             * @param {?} response
                             * @return {?}
                             */
                            function (response) {
                                return _this.getApiResponseBody(response, showValidationResult);
                            })), catchError(this.handleError("put error"))).toPromise()];
                }
            });
        });
    };
    /**
    * DELETE
    * @param url ApiUrl
    * @return API返却結果
    */
    /**
     * DELETE
     * @template T
     * @param {?} url ApiUrl
     * @param {?=} showValidationResult
     * @return {?} API返却結果
     */
    ShHttpClientService.prototype.delete = /**
     * DELETE
     * @template T
     * @param {?} url ApiUrl
     * @param {?=} showValidationResult
     * @return {?} API返却結果
     */
    function (url, showValidationResult) {
        if (showValidationResult === void 0) { showValidationResult = true; }
        return tslib_1.__awaiter(this, void 0, void 0, function () {
            var versionNo, option;
            var _this = this;
            return tslib_1.__generator(this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.versionService.getVersion(url)];
                    case 1:
                        versionNo = _a.sent();
                        option = this.getOption(versionNo);
                        return [2 /*return*/, this.http.delete(url, option).pipe(map((/**
                             * @param {?} response
                             * @return {?}
                             */
                            function (response) {
                                return _this.getApiResponseBody(response, showValidationResult);
                            })), catchError(this.handleError("delete error"))).toPromise()];
                }
            });
        });
    };
    /**
     * エラーハンドラ
     * @param operation どの処理でエラーが起きたか
     * @param result 空の配列か指定無しを返して処理を継続させる
     */
    /**
     * エラーハンドラ
     * @private
     * @template T
     * @param {?=} operation どの処理でエラーが起きたか
     * @param {?=} result 空の配列か指定無しを返して処理を継続させる
     * @return {?}
     */
    ShHttpClientService.prototype.handleError = /**
     * エラーハンドラ
     * @private
     * @template T
     * @param {?=} operation どの処理でエラーが起きたか
     * @param {?=} result 空の配列か指定無しを返して処理を継続させる
     * @return {?}
     */
    function (operation, result) {
        if (operation === void 0) { operation = 'operation'; }
        return (/**
         * @param {?} error
         * @return {?}
         */
        function (error) {
            /** @type {?} */
            var msg = new SHMessage();
            alert(msg.fatal.systemErrorHasOccurred());
            throw error;
        });
    };
    /**
     * urlをエンコードする。インターステージ用の対応
     * @param url
     */
    /**
     * urlをエンコードする。インターステージ用の対応
     * @private
     * @param {?} url
     * @return {?}
     */
    ShHttpClientService.prototype.encodeUrl = /**
     * urlをエンコードする。インターステージ用の対応
     * @private
     * @param {?} url
     * @return {?}
     */
    function (url) {
        if (!url)
            return;
        if (url.indexOf('?')) {
            return encodeURI(url);
        }
        return url;
    };
    ShHttpClientService.decorators = [
        { type: Injectable, args: [{
                    providedIn: 'root'
                },] }
    ];
    /** @nocollapse */
    ShHttpClientService.ctorParameters = function () { return [
        { type: HttpClient },
        { type: VersionService },
        { type: AlertHandlerService },
        { type: ValidationErrorService },
        { type: ShRedirectService }
    ]; };
    /** @nocollapse */ ShHttpClientService.ngInjectableDef = i0.ɵɵdefineInjectable({ factory: function ShHttpClientService_Factory() { return new ShHttpClientService(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.VersionService), i0.ɵɵinject(i3.AlertHandlerService), i0.ɵɵinject(i4.ValidationErrorService), i0.ɵɵinject(i5.ShRedirectService)); }, token: ShHttpClientService, providedIn: "root" });
    return ShHttpClientService;
}());
export { ShHttpClientService };
if (false) {
    /**
     * @type {?}
     * @private
     */
    ShHttpClientService.prototype.http;
    /**
     * @type {?}
     * @private
     */
    ShHttpClientService.prototype.versionService;
    /**
     * @type {?}
     * @private
     */
    ShHttpClientService.prototype.alertHandlerService;
    /**
     * @type {?}
     * @private
     */
    ShHttpClientService.prototype.validationErrorService;
    /**
     * @type {?}
     * @private
     */
    ShHttpClientService.prototype.redirectService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2gtaHR0cC1jbGllbnQuc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL3NoLWh0dHAtY2xpZW50LyIsInNvdXJjZXMiOlsibGliL3NlcnZpY2VzL3NoLWh0dHAtY2xpZW50LnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBRTNDLE9BQU8sRUFBRSxVQUFVLEVBQUUsV0FBVyxFQUFFLE1BQU0sc0JBQXNCLENBQUE7QUFDOUQsT0FBTyxFQUFFLFVBQVUsRUFBRSxHQUFHLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQTtBQUVoRCxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFDbkQsT0FBTyxFQUFFLG1CQUFtQixFQUFFLE1BQU0seUJBQXlCLENBQUM7QUFDOUQsT0FBTyxFQUFFLHNCQUFzQixFQUFFLE1BQU0sNEJBQTRCLENBQUM7QUFDcEUsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLDhCQUE4QixDQUFDO0FBQy9ELE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxRQUFRLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUNuRSxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sd0JBQXdCLENBQUM7QUFDbkQsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0sdUJBQXVCLENBQUM7Ozs7Ozs7QUFFMUQ7SUFLRSw2QkFDVSxJQUFnQixFQUNoQixjQUE4QixFQUM5QixtQkFBd0MsRUFDeEMsc0JBQThDLEVBQzlDLGVBQWtDO1FBSmxDLFNBQUksR0FBSixJQUFJLENBQVk7UUFDaEIsbUJBQWMsR0FBZCxjQUFjLENBQWdCO1FBQzlCLHdCQUFtQixHQUFuQixtQkFBbUIsQ0FBcUI7UUFDeEMsMkJBQXNCLEdBQXRCLHNCQUFzQixDQUF3QjtRQUM5QyxvQkFBZSxHQUFmLGVBQWUsQ0FBbUI7SUFDeEMsQ0FBQztJQUtMLHNCQUFJLHlDQUFRO1FBSFo7O1dBRUc7Ozs7O1FB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QjtnQkFDbkIsc0JBQXNCO2dCQUl0QixpQkFBaUI7Ozs4QkFYMUI7Q0EwTEMsQUE3S0QsSUE2S0M7U0ExS1ksbUJBQW1COzs7Ozs7SUFHNUIsbUNBQXdCOzs7OztJQUN4Qiw2Q0FBc0M7Ozs7O0lBQ3RDLGtEQUFnRDs7Ozs7SUFDaEQscURBQXNEOzs7OztJQUN0RCw4Q0FBMEMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tICdyeGpzJ1xyXG5pbXBvcnQgeyBIdHRwQ2xpZW50LCBIdHRwSGVhZGVycyB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbi9odHRwJ1xyXG5pbXBvcnQgeyBjYXRjaEVycm9yLCBtYXAgfSBmcm9tICdyeGpzL29wZXJhdG9ycydcclxuaW1wb3J0IHsgQXBpUmVzcG9uc2UgfSBmcm9tICcuLi91dGlsaXRpZXMvQXBpUmVzcG9uc2UnO1xyXG5pbXBvcnQgeyBWZXJzaW9uU2VydmljZSB9IGZyb20gJy4vdmVyc2lvbi5zZXJ2aWNlJztcclxuaW1wb3J0IHsgQWxlcnRIYW5kbGVyU2VydmljZSB9IGZyb20gJy4vYWxlcnQtaGFuZGxlci5zZXJ2aWNlJztcclxuaW1wb3J0IHsgVmFsaWRhdGlvbkVycm9yU2VydmljZSB9IGZyb20gJy4vdmFsaWRhdGlvbi1lcnJvci5zZXJ2aWNlJztcclxuaW1wb3J0IHsgQXBpUmVzcG9uc2VCb2R5IH0gZnJvbSAnLi4vdXRpbGl0aWVzL0FwaVJlc3BvbnNlQm9keSc7XHJcbmltcG9ydCB7IFNoSHR0cENsaWVudENvbnN0LCBSZXNwb25zZSB9IGZyb20gJy4uL2NvbnN0U2hIdHRwQ2xpZW50JztcclxuaW1wb3J0IHsgU0hNZXNzYWdlIH0gZnJvbSAnLi4vdXRpbGl0aWVzL1NoTWVzc2FnZSc7XHJcbmltcG9ydCB7IFNoUmVkaXJlY3RTZXJ2aWNlIH0gZnJvbSAnLi9zaC1yZWRpcmVjdC5zZXJ2aWNlJztcclxuXHJcbkBJbmplY3RhYmxlKHtcclxuICBwcm92aWRlZEluOiAncm9vdCdcclxufSlcclxuZXhwb3J0IGNsYXNzIFNoSHR0cENsaWVudFNlcnZpY2Uge1xyXG5cclxuICBjb25zdHJ1Y3RvcihcclxuICAgIHByaXZhdGUgaHR0cDogSHR0cENsaWVudCxcclxuICAgIHByaXZhdGUgdmVyc2lvblNlcnZpY2U6IFZlcnNpb25TZXJ2aWNlLFxyXG4gICAgcHJpdmF0ZSBhbGVydEhhbmRsZXJTZXJ2aWNlOiBBbGVydEhhbmRsZXJTZXJ2aWNlLFxyXG4gICAgcHJpdmF0ZSB2YWxpZGF0aW9uRXJyb3JTZXJ2aWNlOiBWYWxpZGF0aW9uRXJyb3JTZXJ2aWNlLFxyXG4gICAgcHJpdmF0ZSByZWRpcmVjdFNlcnZpY2U6IFNoUmVkaXJlY3RTZXJ2aWNlXHJcbiAgKSB7IH1cclxuXHJcbiAgLyoqXHJcbiAgICogQWNjZXNzVG9rZW7jga7mnInnhKHjgpLov5TjgZlcclxuICAgKi9cclxuICBnZXQgaGFzVG9rZW4oKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gISFzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCdBY2Nlc3NUb2tlbicpO1xyXG4gIH1cclxuICAvKipcclxuICAgKiBodHRwT3B0aW9u44KS6L+U44GZXHJcbiAgICogQHBhcmFtIHZlcnNpb25ObyBcclxuICAgKi9cclxuICBwcml2YXRlIGdldE9wdGlvbih2ZXJzaW9uTm86IHN0cmluZyk6IG9iamVjdCB7XHJcbiAgICBjb25zdCB0b2tlbiA9IHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oYCR7U2hIdHRwQ2xpZW50Q29uc3QuQVVUSE9SSVpBVElPTl9UT0tFTn1gKVxyXG4gICAgbGV0IGhlYWRlcnMgPSBuZXcgSHR0cEhlYWRlcnMoeyBcIlZlcnNpb24tTm9cIjogdmVyc2lvbk5vIH0pXHJcbiAgICBoZWFkZXJzID0gaGVhZGVycy5zZXQoJ0NvbnRlbnQtVHlwZScsICdhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PXV0Zi04Jyk7XHJcbiAgICBjb25zdCBhY2Nlc3NUb2tlbiA9IHRva2VuID8gU2hIdHRwQ2xpZW50Q29uc3QuQmVhcmVyICsgdG9rZW4gOiBTaEh0dHBDbGllbnRDb25zdC5CZWFyZXI7XHJcbiAgICBoZWFkZXJzID0gaGVhZGVycy5zZXQoJ0F1dGhvcml6YXRpb24nLCBhY2Nlc3NUb2tlbik7XHJcbiAgICByZXR1cm4geyBvYnNlcnZlOiBSZXNwb25zZSwgaGVhZGVycyB9O1xyXG4gIH1cclxuICAvKipcclxuICAqIEdFVFxyXG4gICogQHBhcmFtIGFwaVJlc3BvbnNlQm9keSDjg6zjgrnjg53jg7PjgrlCb2R55oOF5aCxXHJcbiAgKiBAcmV0dXJuIOODrOOCueODneODs+OCuUJvZHnlhoXjga5ib2R55Y+lXHJcbiAgKi9cclxuICBwcml2YXRlIGdldEFwaVJlc3BvbnNlQm9keTxUPihhcGlSZXNwb25zZUJvZHk6IEFwaVJlc3BvbnNlPFQ+LCBzaG93VmFsaWRhdGlvblJlc3VsdDogYm9vbGVhbik6IEFwaVJlc3BvbnNlQm9keTxUPiB7XHJcbiAgICBpZiAoYXBpUmVzcG9uc2VCb2R5LnN0YXR1cyAhPSBTaEh0dHBDbGllbnRDb25zdC5TVEFUVVNfT0spXHJcbiAgICAgIHJldHVybiBuZXcgQXBpUmVzcG9uc2VCb2R5PFQ+KCk7XHJcbiAgICBpZiAoYXBpUmVzcG9uc2VCb2R5LmJvZHkpIHtcclxuICAgICAgaWYgKGFwaVJlc3BvbnNlQm9keS5ib2R5Lm1lc3NhZ2UpIHtcclxuICAgICAgICBhbGVydChhcGlSZXNwb25zZUJvZHkuYm9keS5tZXNzYWdlKTtcclxuICAgICAgfVxyXG4gICAgICBpZiAoYXBpUmVzcG9uc2VCb2R5LmJvZHkubWVzc2FnZSkge1xyXG4gICAgICAgIGFsZXJ0KGFwaVJlc3BvbnNlQm9keS5ib2R5Lm1lc3NhZ2UpO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChhcGlSZXNwb25zZUJvZHkuYm9keS5yZWRpcmVjdFVSTCA9PSBTaEh0dHBDbGllbnRDb25zdC5SRUxPQUQpIHtcclxuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7bG9jYXRpb24ucmVsb2FkKCk7fSwgMTAwKTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIGlmICgoYXBpUmVzcG9uc2VCb2R5LmJvZHkucmVkaXJlY3RVUkwgfHwgXCJcIikuaW5kZXhPZihTaEh0dHBDbGllbnRDb25zdC5IVFRQKSAhPSAtMSkge1xyXG4gICAgICAgIC8vIHVzZUhhc2jjgYx0cnVl44Gr44Gq44Gj44Gm44GE44KL44GT44Go44GM5YmN5o+Q5p2h5Lu244Gn44GZXHJcbiAgICAgICAgdGhpcy5yZWRpcmVjdFNlcnZpY2Uuc2V0UmVkaXJlY3RQYXRoKCk7XHJcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe2xvY2F0aW9uLmhyZWYgPSBhcGlSZXNwb25zZUJvZHkuYm9keS5yZWRpcmVjdFVSTH0sIDEwMCk7XHJcbiAgICAgIH1cclxuICAgICAgaWYoc2hvd1ZhbGlkYXRpb25SZXN1bHQpIHtcclxuICAgICAgICAvL+ODkOODquODh+ODvOOCt+ODp+ODs+WHpueQhlxyXG4gICAgICAgIGlmIChhcGlSZXNwb25zZUJvZHkuYm9keS5oYXNWYWxpZGF0aW9uRXJyb3JzKSB7XHJcbiAgICAgICAgICB0aGlzLnZhbGlkYXRpb25FcnJvclNlcnZpY2Uuc2V0VmFsaWRhdGlvbkVycm9yKGFwaVJlc3BvbnNlQm9keS5ib2R5LnZhbGlkYXRpb25FcnJvcnMpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICB0aGlzLnZhbGlkYXRpb25FcnJvclNlcnZpY2UuY2xlYXJWYWxpZGF0aW9uRXJyb3IoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIGlmIChhcGlSZXNwb25zZUJvZHkuYm9keS5hbGVydCkge1xyXG4gICAgICAgIC8v44Ki44Op44O844OI5Yem55CGXHJcbiAgICAgICAgdGhpcy5hbGVydEhhbmRsZXJTZXJ2aWNlLnNldEFsZXJ0KGFwaVJlc3BvbnNlQm9keS5ib2R5LmFsZXJ0KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBhcGlSZXNwb25zZUJvZHkuYm9keTtcclxuICB9XHJcbiAgLyoqXHJcbiAgICog6KqN6Ki85riI44G/44GL44Gp44GG44GLXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBpc0F1dGhlbnRpY2F0ZSgpOiBib29sZWFuIHtcclxuICAgIHJldHVybiAhIXNlc3Npb25TdG9yYWdlLmdldEl0ZW0oYCR7U2hIdHRwQ2xpZW50Q29uc3QuQVVUSE9SSVpBVElPTl9UT0tFTn1gKVxyXG4gIH1cclxuICAvKipcclxuICAqIEdFVFxyXG4gICogQHBhcmFtIHVybCBBcGlVcmxcclxuICAqIEByZXR1cm4gQVBJ6L+U5Y2057WQ5p6cXHJcbiAgKi9cclxuICBwdWJsaWMgYXN5bmMgZ2V0PFQ+KHVybDogc3RyaW5nLCBzaG93VmFsaWRhdGlvblJlc3VsdDogYm9vbGVhbiA9IHRydWUpOiBQcm9taXNlPEFwaVJlc3BvbnNlQm9keTxUPj4ge1xyXG4gICAgbGV0IHZlcnNpb25ObyA9IFwiXCJcclxuICAgIGlmICh0aGlzLmlzQXV0aGVudGljYXRlKCkpIHtcclxuICAgICAgdmVyc2lvbk5vID0gYXdhaXQgdGhpcy52ZXJzaW9uU2VydmljZS5nZXRWZXJzaW9uKHVybCk7XHJcbiAgICB9XHJcbiAgICBjb25zdCBvcHRpb246IG9iamVjdCA9IHRoaXMuZ2V0T3B0aW9uKHZlcnNpb25Obyk7XHJcbiAgICByZXR1cm4gdGhpcy5odHRwLmdldDxBcGlSZXNwb25zZTxUPj4odGhpcy5lbmNvZGVVcmwodXJsKSwgb3B0aW9uKS5waXBlKFxyXG4gICAgICBtYXAocmVzcG9uc2UgPT4ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmdldEFwaVJlc3BvbnNlQm9keTxUPihyZXNwb25zZSwgc2hvd1ZhbGlkYXRpb25SZXN1bHQpO1xyXG4gICAgICB9KSxcclxuICAgICAgY2F0Y2hFcnJvcih0aGlzLmhhbmRsZUVycm9yPGFueT4oXCJnZXQgZXJyb3JcIikpXHJcbiAgICApLnRvUHJvbWlzZSgpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiBQT1NUXHJcbiAgKiBAcGFyYW0gdXJsIEFwaVVybFxyXG4gICogQHBhcmFtIGRhdGEg44OH44O844K/XHJcbiAgKiBAcmV0dXJuIEFQSei/lOWNtOe1kOaenFxyXG4gICovXHJcbiAgcHVibGljIGFzeW5jIHBvc3Q8VD4odXJsOiBzdHJpbmcsIGRhdGE6IGFueSwgc2hvd1ZhbGlkYXRpb25SZXN1bHQ6IGJvb2xlYW4gPSB0cnVlKTogUHJvbWlzZTxBcGlSZXNwb25zZUJvZHk8VD4+IHtcclxuICAgIGNvbnN0IHZlcnNpb25ObyA9IGF3YWl0IHRoaXMudmVyc2lvblNlcnZpY2UuZ2V0VmVyc2lvbih1cmwpO1xyXG4gICAgY29uc3Qgb3B0aW9uOiBvYmplY3QgPSB0aGlzLmdldE9wdGlvbih2ZXJzaW9uTm8pXHJcbiAgICByZXR1cm4gdGhpcy5odHRwLnBvc3Q8QXBpUmVzcG9uc2U8VD4+KHVybCwgZGF0YSwgb3B0aW9uKS5waXBlKFxyXG4gICAgICBtYXAocmVzcG9uc2UgPT4ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmdldEFwaVJlc3BvbnNlQm9keShyZXNwb25zZSwgc2hvd1ZhbGlkYXRpb25SZXN1bHQpO1xyXG4gICAgICB9KSxcclxuICAgICAgY2F0Y2hFcnJvcih0aGlzLmhhbmRsZUVycm9yPGFueT4oXCJwb3N0IGVycm9yXCIpKVxyXG4gICAgKS50b1Byb21pc2UoKTtcclxuXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIFBVVFxyXG4gICogQHBhcmFtIHVybCBBcGlVcmxcclxuICAqIEBwYXJhbSBkYXRhIOODh+ODvOOCv1xyXG4gICogQHJldHVybiBBUEnov5TljbTntZDmnpxcclxuICAqL1xyXG4gIHB1YmxpYyBhc3luYyBwdXQ8VD4odXJsOiBzdHJpbmcsIGRhdGE6IGFueSwgc2hvd1ZhbGlkYXRpb25SZXN1bHQ6IGJvb2xlYW4gPSB0cnVlKTogUHJvbWlzZTxBcGlSZXNwb25zZUJvZHk8VD4+IHtcclxuICAgIGNvbnN0IHZlcnNpb25ObyA9IGF3YWl0IHRoaXMudmVyc2lvblNlcnZpY2UuZ2V0VmVyc2lvbih1cmwpO1xyXG4gICAgY29uc3Qgb3B0aW9uOiBvYmplY3QgPSB0aGlzLmdldE9wdGlvbih2ZXJzaW9uTm8pXHJcbiAgICByZXR1cm4gdGhpcy5odHRwLnB1dDxBcGlSZXNwb25zZTxUPj4odXJsLCBkYXRhLCBvcHRpb24pLnBpcGUoXHJcbiAgICAgIG1hcChyZXNwb25zZSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0QXBpUmVzcG9uc2VCb2R5KHJlc3BvbnNlLCBzaG93VmFsaWRhdGlvblJlc3VsdCk7XHJcbiAgICAgIH0pLFxyXG4gICAgICBjYXRjaEVycm9yKHRoaXMuaGFuZGxlRXJyb3I8YW55PihcInB1dCBlcnJvclwiKSlcclxuICAgICkudG9Qcm9taXNlKCk7XHJcblxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiBERUxFVEVcclxuICAqIEBwYXJhbSB1cmwgQXBpVXJsXHJcbiAgKiBAcmV0dXJuIEFQSei/lOWNtOe1kOaenFxyXG4gICovXHJcbiAgcHVibGljIGFzeW5jIGRlbGV0ZTxUPih1cmw6IHN0cmluZywgc2hvd1ZhbGlkYXRpb25SZXN1bHQ6IGJvb2xlYW4gPSB0cnVlKTogUHJvbWlzZTxBcGlSZXNwb25zZUJvZHk8VD4+IHtcclxuICAgIGNvbnN0IHZlcnNpb25ObyA9IGF3YWl0IHRoaXMudmVyc2lvblNlcnZpY2UuZ2V0VmVyc2lvbih1cmwpO1xyXG4gICAgY29uc3Qgb3B0aW9uOiBvYmplY3QgPSB0aGlzLmdldE9wdGlvbih2ZXJzaW9uTm8pXHJcbiAgICByZXR1cm4gdGhpcy5odHRwLmRlbGV0ZTxBcGlSZXNwb25zZTxUPj4odXJsLCBvcHRpb24pLnBpcGUoXHJcbiAgICAgIG1hcChyZXNwb25zZSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0QXBpUmVzcG9uc2VCb2R5KHJlc3BvbnNlLCBzaG93VmFsaWRhdGlvblJlc3VsdCk7XHJcbiAgICAgIH0pLFxyXG4gICAgICBjYXRjaEVycm9yKHRoaXMuaGFuZGxlRXJyb3I8YW55PihcImRlbGV0ZSBlcnJvclwiKSksXHJcbiAgICApLnRvUHJvbWlzZSgpO1xyXG5cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOOCqOODqeODvOODj+ODs+ODieODqVxyXG4gICAqIEBwYXJhbSBvcGVyYXRpb24g44Gp44Gu5Yem55CG44Gn44Ko44Op44O844GM6LW344GN44Gf44GLXHJcbiAgICogQHBhcmFtIHJlc3VsdCDnqbrjga7phY3liJfjgYvmjIflrprnhKHjgZfjgpLov5TjgZfjgablh6bnkIbjgpLntpnntprjgZXjgZvjgotcclxuICAgKi9cclxuICBwcml2YXRlIGhhbmRsZUVycm9yPFQ+KG9wZXJhdGlvbiA9ICdvcGVyYXRpb24nLCByZXN1bHQ/OiBUKSB7XHJcbiAgICByZXR1cm4gKGVycm9yOiBhbnkpOiBPYnNlcnZhYmxlPFQ+ID0+IHtcclxuICAgICAgY29uc3QgbXNnOiBTSE1lc3NhZ2UgPSBuZXcgU0hNZXNzYWdlKCk7XHJcbiAgICAgIGFsZXJ0KG1zZy5mYXRhbC5zeXN0ZW1FcnJvckhhc09jY3VycmVkKCkpO1xyXG4gICAgICB0aHJvdyBlcnJvcjtcclxuICAgIH07XHJcblxyXG4gIH1cclxuICAvKipcclxuICAgKiB1cmzjgpLjgqjjg7PjgrPjg7zjg4njgZnjgovjgILjgqTjg7Pjgr/jg7zjgrnjg4bjg7zjgrjnlKjjga7lr77lv5xcclxuICAgKiBAcGFyYW0gdXJsIFxyXG4gICAqL1xyXG4gIHByaXZhdGUgZW5jb2RlVXJsKHVybDogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgIGlmICghdXJsKSByZXR1cm47XHJcbiAgICBpZiAodXJsLmluZGV4T2YoJz8nKSkge1xyXG4gICAgICByZXR1cm4gZW5jb2RlVVJJKHVybCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdXJsO1xyXG4gIH1cclxufVxyXG4iXX0=